!function(t,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r():"function"==typeof define&&define.amd?define(r):t.VueImg=r()}(this,function(){"use strict";var t=Object.create(null);t.canWebp=!1;var r=new Image;r.onload=function(){t.canWebp=!0},r.src="data:image/webp;base64,UklGRkoAAABXRUJQVlA4WAoAAAAQAAAAAAAAAAAAQUxQSAsAAAABBxAREYiI/gcAAABWUDggGAAAADABAJ0BKgEAAQABABwlpAADcAD+/gbQAA==";var e="https:"===location.protocol?"https://":"http://",o=document.domain.match(/.(alpha|beta).ele(net)?.me$/);t.cdn=e+(o?"fuss"+o[0]:"fuss10.elemecdn.com");var n=function(t){return t.replace(/^(\w)(\w\w)(\w{29}(\w*))$/,"/$1/$2/$3.$4")},a=function(r){var e=r.format,o=r.fallback,n=/^(jpg|jpeg|png|gif)$/;return n.test(e)?"format/"+e+"/":t.canWebp?"format/webp/":n.test(o)?"format/"+o+"/":""},i=function(t){var r=t.width,e=t.height,o="thumbnail/",n=r+"x"+e;return r&&e?o+"!"+n+"r/gravity/Center/crop/"+n+"/":r?""+o+r+"x/":e?o+"x"+e+"/":""},c=function(r){void 0===r&&(r={});var e=r.hash,o=r.width,c=r.height,f=r.quality,u=r.format,s=r.fallback,h=r.prefix,p=r.suffix;if(!e||"string"!=typeof e)return"";var A="string"==typeof h?h:t.cdn,l="number"==typeof f?"quality/"+f+"/":"",g=a({format:u,fallback:s}),d=i({width:o,height:c}),m="string"==typeof p?p:"",y=""+l+g+d+m;return A+n(e)+(y?"?imageMogr/"+y:"")},f=function(t,r){return Object.prototype.hasOwnProperty.call(t,r)},u=function(t){var r=t.source,e=t.target;t.keys.forEach(function(t){f(r,t)&&(e[t]=r[t])})},s=function(t,r,e){"img"===e?t.src=r:t.style.backgroundImage="url('"+r+"')"},h=function(t){void 0===t&&(t={});var r=function(){u({source:t,target:this,keys:["loading","error","quality","prefix","suffix"]})};return r.prototype.hashToSrc=function(t){var r={hash:t};return u({source:this,target:r,keys:["width","height","quality","format","fallback","prefix","suffix"]}),c(r)},function(t){function r(r){var e=r&&"object"==typeof r?r:{hash:r};t.call(this),u({source:e,target:this,keys:["hash","loading","error","width","height","quality","format","fallback","prefix","suffix"]})}return t&&(r.__proto__=t),r.prototype=Object.create(t&&t.prototype),r.prototype.constructor=r,r.prototype.toImageSrc=function(){return this.hashToSrc(this.hash)},r.prototype.toLoadingSrc=function(){return this.hashToSrc(this.loading)},r.prototype.toErrorSrc=function(){return this.hashToSrc(this.error)},r}(r)},p=function(t,r){var e=h(r),o=function(t,r,o){var n=new e(r.value),a=n.toImageSrc(),i=n.toErrorSrc();if(a){var c=new Image;c.onload=function(){s(t,a,o.tag)},i&&(c.onerror=function(){s(t,i,o.tag)}),c.src=a}};t.directive("img",{bind:function(t,r,n){var a=new e(r.value).toLoadingSrc();a&&s(t,a,n.tag),o(t,r,n)},update:o})};return t.getSrc=c,t.install=p,t});